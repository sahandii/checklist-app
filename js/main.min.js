"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var Model=function(){function Model(){_classCallCheck(this,Model),this.todos=JSON.parse(localStorage.getItem("todos"))||[]}return _createClass(Model,[{key:"bindTodoListChanged",value:function bindTodoListChanged(callback){this.onTodoListChanged=callback}},{key:"_commit",value:function _commit(todos){this.onTodoListChanged(todos),localStorage.setItem("todos",JSON.stringify(todos))}},{key:"addTodo",value:function addTodo(todoText){var todo={id:this.todos.length>0?this.todos[this.todos.length-1].id+1:1,text:todoText,complete:!1};this.todos.push(todo),this._commit(this.todos)}},{key:"editTodo",value:function editTodo(id,updatedText){this.todos=this.todos.map((function(todo){return todo.id===id?{id:todo.id,text:updatedText,complete:todo.complete}:todo})),this._commit(this.todos)}},{key:"deleteTodo",value:function deleteTodo(id){this.todos=this.todos.filter((function(todo){return todo.id!==id})),this._commit(this.todos)}},{key:"toggleTodo",value:function toggleTodo(id){this.todos=this.todos.map((function(todo){return todo.id===id?{id:todo.id,text:todo.text,complete:!todo.complete}:todo})),this._commit(this.todos)}}]),Model}(),View=function(){function View(){_classCallCheck(this,View),this.todoList=document.querySelector(".todo-item--container"),this.form=document.querySelector("form"),this.input=document.querySelector("input"),this._temporaryTodoText="",this._initLocalListeners()}return _createClass(View,[{key:"bindAddTodo",value:function bindAddTodo(handler){var _this=this;this.form.addEventListener("submit",(function(event){event.preventDefault(),_this._todoText?(handler(_this._todoText),_this._resetInput()):console.log("Write something!")}))}},{key:"displayTodos",value:function displayTodos(todos){for(var _this2=this;this.todoList.firstChild;)this.todoList.removeChild(this.todoList.firstChild);if(0===todos.length){var emptyTodo='\n\t\t\t\t<div class="empty-message px-3 text-center">\n\t\t\t\t\t<h4>Let\'s get some work done! &#10548;</h4>\n\t\t\t\t</div>\n\t\t\t';this.todoList.innerHTML+=emptyTodo}else todos.forEach((function(todo){var todoItem='\n\t\t\t\t<div id="'.concat(todo.id,'" class="').concat(todo.complete?"checked ":"",'todo-item d-flex justify-content-between align-items-center flex-row mx-3 my-2">\n\t\t\t\t\t<button class="circle-small checkbox mx-3"></button>\n\t\t\t\t\t<div class="todo-item--title text-left w-100">\n\t\t\t\t\t\t<h4 contenteditable="true" tabindex="').concat(todo.id,'" class="editable">').concat(todo.text,'</h4>\n\t\t\t\t\t</div>\n\t\t\t\t\t<i style="color:#E02020" class="delete fas fa-trash p-3"></i>\n\t\t\t\t</div>');todo.complete&&console.log(todo),_this2.todoList.innerHTML+=todoItem}));console.log(todos)}},{key:"_initLocalListeners",value:function _initLocalListeners(){var _this3=this;this.todoList.addEventListener("input",(function(event){"editable"===event.target.className&&(_this3._temporaryTodoText=event.target.innerText)}))}},{key:"bindAddTodo",value:function bindAddTodo(handler){var _this4=this;this.form.addEventListener("submit",(function(event){event.preventDefault(),_this4._todoText&&(handler(_this4._todoText),_this4._resetInput())}))}},{key:"bindDeleteTodo",value:function bindDeleteTodo(handler){this.todoList.addEventListener("click",(function(event){if(event.target.className.includes("delete")){var id=parseInt(event.target.parentElement.id);handler(id)}}))}},{key:"bindEditTodo",value:function bindEditTodo(handler){var _this5=this;this.todoList.addEventListener("focusout",(function(event){if(_this5._temporaryTodoText){var id=parseInt(event.target.parentElement.parentElement.id);handler(id,_this5._temporaryTodoText),_this5._temporaryTodoText=""}}))}},{key:"bindToggleTodo",value:function bindToggleTodo(handler){this.todoList.addEventListener("click",(function(event){if(event.target.className.includes("checkbox")){var id=parseInt(event.target.parentElement.id);handler(id)}}))}},{key:"createElement",value:function createElement(tag,name){var element=document.createElement(tag);return name&&element.classList.add(name),element}},{key:"_resetInput",value:function _resetInput(){this.input.value=""}},{key:"_todoText",get:function get(){return this.input.value}}]),View}(),Controller=function Controller(model,view){var _this6=this;_classCallCheck(this,Controller),_defineProperty(this,"onTodoListChanged",(function(todos){_this6.view.displayTodos(todos)})),_defineProperty(this,"handleAddTodo",(function(todoText){_this6.model.addTodo(todoText)})),_defineProperty(this,"handleEditTodo",(function(id,todoText){_this6.model.editTodo(id,todoText)})),_defineProperty(this,"handleDeleteTodo",(function(id){_this6.model.deleteTodo(id)})),_defineProperty(this,"handleToggleTodo",(function(id){_this6.model.toggleTodo(id)})),this.model=model,this.view=view,this.model.bindTodoListChanged(this.onTodoListChanged),this.view.bindAddTodo(this.handleAddTodo),this.view.bindEditTodo(this.handleEditTodo),this.view.bindDeleteTodo(this.handleDeleteTodo),this.view.bindToggleTodo(this.handleToggleTodo),this.onTodoListChanged(this.model.todos)},app=new Controller(new Model,new View);